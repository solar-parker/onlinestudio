<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Cursor Distortion Demo</title>
  <style>
    :root {
      --cursor-size: 180px;          /* diameter of the distortion area */
      --blur-amt: 12px;              /* blur strength */
      --contrast-amt: 1.15;          /* subtle contrast pop */
      --saturate-amt: 1.1;           /* subtle saturation pop */
    }

    /* Base page styles (demo only) */
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      line-height: 1.5;
      color: #0f172a;
      background: linear-gradient(135deg,#fafafa,#f1f5f9);
      overflow-x: hidden;
      /* Hide the default cursor on pointer devices so our custom one feels native */
      cursor: none;
    }

    header, main, section {
      max-width: 1100px; margin: 0 auto; padding: 4rem 1.25rem;
    }

    .cards { display: grid; grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); gap: 1rem; }
    .card {
      background: white; border-radius: 1.25rem; padding: 1.25rem; box-shadow: 0 8px 24px rgba(2,6,23,.08);
      border: 1px solid rgba(2,6,23,.06);
    }

    /* === Distortion Cursor === */
    #distortion-cursor {
      position: fixed;
      top: 0; left: 0;
      width: var(--cursor-size);
      height: var(--cursor-size);
      border-radius: 50%;
      pointer-events: none;          /* don't block clicks */
      z-index: 9999;                 /* above everything */
      transform: translate3d(-1000px,-1000px,0); /* start off-screen */
      transition: transform 60ms linear; /* responsive but smooth */

      /* The magic: distort whatever is BEHIND this circle */
      backdrop-filter: blur(var(--blur-amt)) contrast(var(--contrast-amt)) saturate(var(--saturate-amt));
      -webkit-backdrop-filter: blur(var(--blur-amt)) contrast(var(--contrast-amt)) saturate(var(--saturate-amt));
    }

    /* Add a subtle refraction rim so the effect reads as a lens */
    #distortion-cursor::after {
      content: "";
      position: absolute; inset: 0;
      border-radius: inherit;
      border: 1px solid rgba(15, 23, 42, 0.18);
      box-shadow: inset 0 0 24px rgba(0,0,0,0.08), 0 2px 12px rgba(0,0,0,0.06);
    }

    /* Accessibility: honor reduced motion */
    @media (prefers-reduced-motion: reduce) {
      #distortion-cursor { transition: none; }
    }

    /* Touch devices: keep the native cursor hidden state sensible */
    @media (hover: none) and (pointer: coarse) {
      body { cursor: auto; }
    }

    /* Optional toggle hint */
    .hint {
      position: fixed; bottom: 10px; right: 12px; z-index: 10000;
      background: rgba(15,23,42,.7); color: #fff; padding: .5rem .75rem; border-radius: .75rem;
      font-size: 12px; user-select: none;
    }
  </style>
</head>
<body>
  <!-- Demo content (replace with your site’s content) -->
  <header>
    <h1>Cursor Distortion Effect</h1>
    <p>Move your pointer around — the circular “lens” distorts the page in real time using <code>backdrop-filter</code>. Drop this snippet into any site; no libraries required.</p>
  </header>

  <main>
    <section class="cards">
      <div class="card"><h3>Installation</h3><p>Wrap nothing! This effect overlays the page; it doesn’t require restructuring your DOM.</p></div>
      <div class="card"><h3>Performance</h3><p>Uses GPU-accelerated backdrop filters. You can tune <code>--cursor-size</code> and <code>--blur-amt</code> for your needs.</p></div>
      <div class="card"><h3>Accessibility</h3><p>Respects <code>prefers-reduced-motion</code> and includes a keyboard toggle.</p></div>
      <div class="card"><h3>Compatibility</h3><p>Works in modern browsers (Safari, Chrome, Edge, Firefox with backdrop-filter support). Gracefully degrades where unsupported.</p></div>
    </section>
  </main>

  <!-- The distortion lens -->
  <div id="distortion-cursor" aria-hidden="true"></div>
  <div class="hint" id="toggle-hint">Press <kbd>D</kbd> to toggle distortion</div>

  <script>
    (function() {
      const el = document.getElementById('distortion-cursor');
      const hint = document.getElementById('toggle-hint');

      // Feature detect backdrop-filter; if unsupported, hide the effect
      const supportsBackdrop = CSS.supports('backdrop-filter','blur(1px)') || CSS.supports('-webkit-backdrop-filter','blur(1px)');
      if (!supportsBackdrop) {
        el.style.display = 'none';
        if (hint) hint.textContent = 'Distortion disabled (no backdrop-filter support)';
        return;
      }

      let enabled = true;
      const size = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--cursor-size')) || 180;

      function move(x, y) {
        el.style.transform = `translate3d(${x - size / 2}px, ${y - size / 2}px, 0)`;
      }

      window.addEventListener('pointermove', (e) => {
        if (!enabled) return;
        move(e.clientX, e.clientY);
      }, { passive: true });

      // Keep lens visible on enter; hide when leaving viewport
      window.addEventListener('pointerenter', (e) => enabled && (el.style.opacity = '1'), { passive: true });
      window.addEventListener('pointerleave', (e) => (el.style.opacity = '0'), { passive: true });

      // Keyboard toggle for accessibility (press "D")
      window.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 'd') {
          enabled = !enabled;
          el.style.opacity = enabled ? '1' : '0';
          if (hint) hint.textContent = enabled ? 'Press D to toggle distortion' : 'Distortion off — press D to re‑enable';
        }
      });

      // Initial position to center
      move(window.innerWidth/2, window.innerHeight/2);
    })();
  </script>
</body>
</html>